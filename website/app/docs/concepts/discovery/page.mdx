# Discovery

How AGPM discovers artifacts in source repositories.

## Overview

AGPM automatically discovers artifacts by scanning source repositories for specific file patterns and directory structures.

## Discovery Formats

AGPM discovers artifacts in three formats:

### claude-marketplace

Repositories with a `.claude-plugin/marketplace.json` file:

```json
{
  "plugins": [
    {
      "name": "plugin-name",
      "source": "./",
      "skills": ["./skills/pdf", "./skills/docx"]
    }
  ]
}
```

Each plugin's `source` directory should contain a `skills/` subdirectory with individual skills.

### claude-plugin

Repositories with a `.claude-plugin/plugin.json` file:

```json
{
  "name": "plugin-name",
  "skills": "./custom/skills/"
}
```

This format allows specifying a custom skills directory path.

### simple

Repositories with a top-level `skills/` directory containing skill subdirectories with `metadata.json`:

```text
repo/
└── skills/
    ├── pdf/
    │   └── metadata.json
    └── web-search/
        └── metadata.json
```

## Discovery Process

When you run `agpm source discover` or `agpm add`:

1. Repository is cloned to `~/.agpm/repos/`
2. AGPM checks for `.claude-plugin/marketplace.json`
3. If not found, checks for `.claude-plugin/plugin.json`
4. If not found, checks for `skills/` directory
5. Scans for metadata files
6. Parses artifact metadata

## See Also

- [Sources](/docs/concepts/sources) - Source repository formats
- [source discover](/docs/commands/source) - Discovery command
